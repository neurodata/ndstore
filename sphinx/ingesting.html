

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>How to Ingest Data &mdash; open-connectome v0.7.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/ocp_favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="open-connectome v0.7.0 documentation" href="../index.html"/>
        <link rel="next" title="Configuration" href="config.html"/>
        <link rel="prev" title="Administrator Console" href="console.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> open-connectome
          

          
            
            <img src="../_static/ocp_main.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                v0.7.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">NeuroData Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="datamodel.html">Data Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="console.html">Administrator Console</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">How to Ingest Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#prepping-the-data">Prepping The Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#some-common-mistakes-you-can-make">Some common mistakes you can make</a></li>
<li class="toctree-l2"><a class="reference internal" href="#unsupported-image-types">Unsupported Image Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="#help-section">Help Section</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#how-do-i-check-the-image-size-of-my-data">How do I check the image size of my data?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-do-i-check-the-datatype">How do I check the datatype?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-do-i-name-my-projects-datasets-token">How do I name my projects/datasets/token?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-do-i-check-if-my-data-is-publicly-accessible">How do I check if my data is publicly accessible?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#s3-bucket-upload">S3 Bucket Upload</a></li>
<li class="toctree-l2"><a class="reference internal" href="#uploading">Uploading</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#explanation-of-additional-terms">Explanation of Additional Terms</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions (FAQ)</a></li>
</ul>
<p class="caption"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/nd_types.html">NeuroData Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/info_api.html">Project Info API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/public_api.html">Public Token API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/data_api.html">Data API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/ramon_api.html">RAMON API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/propagate_api.html">Propagate API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/stats_api.html">Statistics API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/json_api.html">JSON API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/overlay_api.html">Overlay API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/tile_api.html">Tile API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/graphgen_api.html">GrahpGen API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/nifti_api.html">NIFTI API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/swc_api.html">SWC API</a></li>
</ul>
<p class="caption"><span class="caption-text">Further Reading</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/functions.html">ndstore Functions</a></li>
<li class="toctree-l1"><a class="reference external" href="https://groups.google.com/forum/#!forum/ocp-support/">Mailing List</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/neurodata/ndstore">Github repo</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/neurodata/ndstore/releases/">Release Notes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">open-connectome</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>How to Ingest Data</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/sphinx/ingesting.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="how-to-ingest-data">
<h1>How to Ingest Data<a class="headerlink" href="#how-to-ingest-data" title="Permalink to this headline">¶</a></h1>
<div class="section" id="prepping-the-data">
<h2>Prepping The Data<a class="headerlink" href="#prepping-the-data" title="Permalink to this headline">¶</a></h2>
<p>There are two important components to how data should be organized before uploading to the service. First is file hierarchy (how the folders holding data should be organized) which is as follows; all channel specific data is saved in a folder with the name of the channel. For example if you have image data of two mouse cortices, one cortex would be stored in an image channel Cortex1. So, all the data from that imaging would be stored in a folder named Cortex1. In the case of time series data each channel folder should contain sub-folders time0, time1, time2, ..., timeN, each of which contains the image data for that specific time slot. All the channel folders should be stored inside a folder named the same as the token name. Note that the token name you choose must be unique across all projects in NeuroData.</p>
<p>Second is how the files themselves are organized. Currently the auto-ingest service only supports tiff, tif, and png files. The files should be organized such that there is a tiff/png/tif for each Z-slice, with each named the slice number up to 4 digits. For example if there was a imaging set with 405 image slices in tif form, the image channel folder(s) should have files labeled 0000.tif through 0404.tif. Files must not have a prefix or suffix to the number of the slice. If the slice number starts at a value other than 0000, please specify that starting value as the Z offset.</p>
<div class="figure align-center" id="id1">
<a class="reference internal image-reference" href="../_images/ingesting_directory.png"><img alt="../_images/ingesting_directory.png" src="../_images/ingesting_directory.png" style="width: 450px; height: 550px;" /></a>
<p class="caption"><span class="caption-text">This figure illustrated visually how the data should be organized for ingest.</span></p>
</div>
</div>
<div class="section" id="some-common-mistakes-you-can-make">
<h2>Some common mistakes you can make<a class="headerlink" href="#some-common-mistakes-you-can-make" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Special characters and spaces in channel/project/dataset/token names not allowed with the exception of an underscore.</li>
<li>Numbering the channel slices incorrectly compared to the offset and number of slices defined in the dataset when ingesting.</li>
<li>Offset (Z value) should match the lowest image file number.</li>
<li>Channel types are not capitalized, so they should be image/annotation not Image/Annotation.</li>
<li>Check if the dataset name is already taken, if it is you must use another.</li>
<li>If you upload multiple channels at once they must all be part of the same dataset.</li>
<li>Check if you have the lastest version of ndio using &#8220;pip install -U ndio&#8221;.</li>
<li>Make sure your directory structure is accurate and correctly ordered.</li>
<li>Make sure your data is HTTP accessible, see below how to check this if you are unsure.</li>
</ul>
</div>
<div class="section" id="unsupported-image-types">
<h2>Unsupported Image Types<a class="headerlink" href="#unsupported-image-types" title="Permalink to this headline">¶</a></h2>
<p>We currently do not support 3-D tiffs.</p>
</div>
<div class="section" id="help-section">
<h2>Help Section<a class="headerlink" href="#help-section" title="Permalink to this headline">¶</a></h2>
<div class="section" id="how-do-i-check-the-image-size-of-my-data">
<h3>How do I check the image size of my data?<a class="headerlink" href="#how-do-i-check-the-image-size-of-my-data" title="Permalink to this headline">¶</a></h3>
<p>Use the &#8216;tiffinfo&#8217; command in terminal to check datatype on tiff (or tif) images, or pnginfo for png images, to get a variety of data about a particular image file including image size.</p>
</div>
<div class="section" id="how-do-i-check-the-datatype">
<h3>How do I check the datatype?<a class="headerlink" href="#how-do-i-check-the-datatype" title="Permalink to this headline">¶</a></h3>
<p>Unfortunately there is no universally acceptable answer to this question, as everyone&#8217;s data types vary based on how the image was saved. The most common answer to this is to use the &#8216;tiffinfo&#8217; command in terminal to check datatype on tiff (or tif) images, or pnginfo for png images.</p>
</div>
<div class="section" id="how-do-i-name-my-projects-datasets-token">
<h3>How do I name my projects/datasets/token?<a class="headerlink" href="#how-do-i-name-my-projects-datasets-token" title="Permalink to this headline">¶</a></h3>
<p>Please see naming convections in the <a class="reference internal" href="datamodel.html#datamodel"><span>data model</span></a>.</p>
</div>
<div class="section" id="how-do-i-check-if-my-data-is-publicly-accessible">
<h3>How do I check if my data is publicly accessible?<a class="headerlink" href="#how-do-i-check-if-my-data-is-publicly-accessible" title="Permalink to this headline">¶</a></h3>
<p>The most common way of doing this is by doing a curl or wget on the data. For example, if you have your data stored on a server with a name space of MyServer on your network, with your publicly accessible folder named MyPublic containing the data, you would attempt to access <a class="reference external" href="http://MyServer/MyPublic/TokenName/ChannelName">http://MyServer/MyPublic/TokenName/ChannelName</a>/###.tif where TokenName and ChannelName are replaced by the token and channel names used in your data and the pound signs are replaced with whichever slice number is desired. The command in terminal would be &#8220;curl <a class="reference external" href="http://MyServer/MyPublic/TokenName/ChannelName">http://MyServer/MyPublic/TokenName/ChannelName</a>/###.tif&#8221; and if there is a response other than webpage not found the data is accessible.</p>
</div>
</div>
<div class="section" id="s3-bucket-upload">
<h2>S3 Bucket Upload<a class="headerlink" href="#s3-bucket-upload" title="Permalink to this headline">¶</a></h2>
<p>If you are uploading data through an amazon s3 bucket, this additional step is necessary for us to be able to access the data. In order to make the data in your S3 bucket public and available over HTTP you need to add this bucket policy (in the permissions tab of properties) and save it. Make sure to replace the &#8220;examplebucket&#8221; in the sample json with your bucket name. When including the data url be sure to set the data_url as <a class="reference external" href="http:/">http:/</a>/&lt;example-bucket&gt;.s3.amazonaws.com/ (with example-bucket being replaced with your bucket name).</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">{</span>
  <span class="nt">&quot;Version&quot;</span><span class="p">:</span><span class="s2">&quot;2012-10-17&quot;</span><span class="p">,</span>
    <span class="nt">&quot;Statement&quot;</span><span class="p">:[</span>
      <span class="p">{</span>
        <span class="nt">&quot;Sid&quot;</span><span class="p">:</span><span class="s2">&quot;AddPerm&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Effect&quot;</span><span class="p">:</span><span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Principal&quot;</span><span class="p">:</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Action&quot;</span><span class="p">:[</span><span class="s2">&quot;s3:GetObject&quot;</span><span class="p">],</span>
        <span class="nt">&quot;Resource&quot;</span><span class="p">:[</span><span class="s2">&quot;arn:aws:s3:::examplebucket/*&quot;</span><span class="p">]</span>
      <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="uploading">
<h2>Uploading<a class="headerlink" href="#uploading" title="Permalink to this headline">¶</a></h2>
<div class="section" id="overview">
<h3>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h3>
<p>This section will initially address how to upload one channels worth of material. Located in the auto-ingest folder in the ingest folder of ndstore is a file named generatejson.py (<a class="reference external" href="https://github.com/neurodata/ndstore/blob/master/ingest/autoingest/generatejson.py">https://github.com/neurodata/ndstore/blob/master/ingest/autoingest/generatejson.py</a>). To upload your data edit the hard-coded values in the code to reflect your data, being sure to specify that you are trying to put data to <a class="reference external" href="http://openconnecto.me">http://openconnecto.me</a> and your DataURL is http accessible (if it is not the script will fail). The editable portion of the script is below the &#8220;Edit the below values&#8221; and above the &#8220;Edit above here&#8221; comment. Once the script has run you do not need to maintain a connection to the script. The script can be run simply by calling &#8220;python2 generatejson.py&#8221; on the script (using python 2.7). In the event that more than one channels worth of data needs to be ingested at once, the service supports this operation as well. To add channels, add additional create channel calls to the AutoIngest object before posting the data. The AutoIngest object is part of NeuroData&#8217;s python library, Ndio, which must be installed prior to using the script.</p>
</div>
<div class="section" id="explanation-of-additional-terms">
<h3>Explanation of Additional Terms<a class="headerlink" href="#explanation-of-additional-terms" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="datamodel.html#datamodel"><span>data model</span></a> holds an explanation of the majority of the terms encountered when editing the generatejson.py script, however some extra terms that are not enumerated in that explanation are included here.</p>
<dl class="function">
<dt id="Scaling">
<code class="descname">Scaling</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Scaling" title="Permalink to this definition">¶</a></dt>
<dd><p>Scaling is the orientation of the data being stored, 0 corresponds to a Z-slice orientation (as in a collection of tiff images in which each tiff is a slice on the z plane) and 1 corresponds to an isotropic orientation (in which each tiff is a slice on the y plane).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">INT</td>
</tr>
<tr class="field-even field"><th class="field-name">Default:</th><td class="field-body">1</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Exceptions">
<code class="descname">Exceptions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Exceptions" title="Permalink to this definition">¶</a></dt>
<dd><p>Exceptions is an option to enable the possibility for annotations to contradict each other (assign different values to the same point). 1 corresponds to True, 0 corresponds to False.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">INT</td>
</tr>
<tr class="field-even field"><th class="field-name">Default:</th><td class="field-body">0</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<code class="descname">Read Only</code></dt>
<dd><p>This option allows the user to control if, after the initial data commit, the channel is read-only. Generally this is suggested with data that will be publicly viewable. 1 corresponds to True, 0 corresponds to False.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">INT</td>
</tr>
<tr class="field-even field"><th class="field-name">Default:</th><td class="field-body">0</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<code class="descname">Data URL</code></dt>
<dd><p>This url points to the root directory of the files, meaning the folder identified by the token name should be in the directory being pointed to. Dropbox (or any data requiring authentication to download such as non-HTTP s3) is not an acceptable HTTP Server. To make data in s3 available for ingest through out service, please see the instructions above.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">AlphaNumeric</td>
</tr>
<tr class="field-even field"><th class="field-name">Default:</th><td class="field-body">None</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><a class="reference external" href="http://ExampleServer.University.edu/MyData/UploadData/">http://ExampleServer.University.edu/MyData/UploadData/</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<code class="descname">File Format</code></dt>
<dd><p>File format refers to the overarching kind of data, as in slices (normal image data) or catmaid (tile-based).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">{SLICE, CATMAID}</td>
</tr>
<tr class="field-even field"><th class="field-name">Default:</th><td class="field-body">None</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body">SLICE</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<code class="descname">File Type</code></dt>
<dd><p>File type refers to the specific type of file that the data is stored in, as in, tiff, png, or tif.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">AlphaNumeric</td>
</tr>
<tr class="field-even field"><th class="field-name">Default:</th><td class="field-body">None</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body">tiff</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="config.html" class="btn btn-neutral float-right" title="Configuration" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="console.html" class="btn btn-neutral" title="Administrator Console" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Open Connectome Project.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'v0.7.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>